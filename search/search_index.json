{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Civillis","text":"<p>Build more, spawn less. Hostile mobs naturally avoid civilized areas.</p> <p>Civillis is a Fabric mod that suppresses hostile mob spawning near player-built structures by computing a real-time civilization score based on block composition. No special items, no commands \u2014 just play, and the land responds.</p>"},{"location":"#quick-start","title":"Quick Start","text":"<ol> <li>Install Fabric Loader \u2265 0.15.0 and Fabric API</li> <li>Drop the Civillis jar into your <code>mods/</code> folder</li> <li>Launch the game \u2014 civilization protection is active immediately</li> </ol> <p>Optional: install Mod Menu + Cloth Config for the in-game settings GUI.</p>"},{"location":"#core-concepts","title":"Core Concepts","text":"<ul> <li>How It Works \u2014 civilization scoring, detection range, spawn suppression</li> <li>Blocks &amp; Scoring \u2014 which blocks count and how much they weigh</li> <li>Civilization Decay \u2014 how protection fades and recovers</li> <li>Monster Heads \u2014 spawn gate bypass, distant redirection, mob conversion</li> <li>Mob Flee AI \u2014 hostile mob retreat behavior in civilized zones</li> <li>Civilization Detector \u2014 sonar pulse, boundary walls, visual feedback</li> </ul>"},{"location":"#configuration","title":"Configuration","text":"<ul> <li>Configuration Guide \u2014 GUI settings, civil.properties, advanced parameters</li> </ul>"},{"location":"#for-modpack-authors","title":"For Modpack Authors","text":"<ul> <li>Data-Driven Registries \u2014 adding blocks and skull types via JSON datapacks</li> <li>Built-in Compatibility \u2014 Farmer's Delight, Supplementaries, Create</li> </ul>"},{"location":"#technical","title":"Technical","text":"<ul> <li>Architecture Overview \u2014 the shard-based civilization engine</li> <li>Performance \u2014 O(1) queries, delta propagation, benchmarks</li> </ul>"},{"location":"blocks-and-scoring/","title":"Blocks &amp; Scoring","text":"<p>Scoring works in two stages. First, each recognized block contributes its weight to the voxel chunk (16\u00d716\u00d716 area) it belongs to, producing a per-chunk civilization score. Then, all chunk scores within the detection range are aggregated into a final score for the spawn point being evaluated. Unrecognized blocks contribute nothing.</p>"},{"location":"blocks-and-scoring/#weight-framework","title":"Weight Framework","text":"<p>Block weights follow a progression based on crafting complexity and symbolic significance:</p> Era Weight Range Examples Stone Age 0.2\u20130.3 Crafting table, furnace, chest, farmland, barrel Iron Age 0.4\u20130.5 Lanterns, workstations, campfires, lecterns Advanced 0.6\u20131.0 Beds, anvils, shulker boxes, brewing stands, sea lanterns Mythic 2.0\u20135.0 Respawn anchors, enchanting tables, beacons, conduits <p>Blocks that emit light or have magical properties receive additional weight within their era.</p>"},{"location":"blocks-and-scoring/#vanilla-block-weights","title":"Vanilla Block Weights","text":"Block Weight Block Weight Beacon 5.0 Lantern 0.4 Conduit 5.0 Soul Lantern 0.4 Respawn Anchor 2.0 Trapped Chest 0.4 Enchanting Table 1.5 Crafting Table 0.3 Lodestone 1.5 Furnace 0.3 Brewing Stand 1.0 Chest 0.3 Sea Lantern 1.0 Barrel 0.3 Bell 0.8 Farmland 0.3 Ender Chest 0.8 Composter 0.3 Beds (all types) 0.7 Beehive 0.3 Redstone Lamp 0.7 Decorated Pot 0.3 Anvils (all types) 0.6 Bee Nest 0.2 Shulker Boxes (all) 0.6 Campfires (all types) 0.5 Stonecutter 0.5 Cartography Table 0.5 Smithing Table 0.5 Fletching Table 0.5 Loom 0.5 Grindstone 0.5 Blast Furnace 0.5 Smoker 0.5 Lectern 0.5 End Rod 0.5 <p>Entries marked \"all types\" use block tags \u2014 all variants (e.g., oak bed, spruce bed) share the same weight.</p>"},{"location":"blocks-and-scoring/#mod-compatibility","title":"Mod Compatibility","text":"<p>Civillis ships with built-in scoring for blocks from popular mods:</p>"},{"location":"blocks-and-scoring/#farmers-delight","title":"Farmer's Delight","text":"<p>Stoves (0.5), cooking pots (0.5), cutting boards (0.3), baskets (0.3), and all cabinet variants (0.4).</p>"},{"location":"blocks-and-scoring/#supplementaries","title":"Supplementaries","text":"<p>Netherite doors (0.8), safes (0.5), globes (0.5), hourglasses (0.5), sconces, jars, and various decorative blocks (0.2\u20130.4).</p>"},{"location":"blocks-and-scoring/#create","title":"Create","text":"<p>Steam engines (1.0), mechanical crafters (0.9), blaze burners (0.8), deployers (0.8), mechanical arms (0.8), and various mechanical blocks (0.3\u20130.7).</p> <p>If a mod is not installed, its block entries are silently ignored \u2014 no errors, no performance cost.</p>"},{"location":"blocks-and-scoring/#data-driven","title":"Data-Driven","text":"<p>All block weights are loaded from JSON data files and can be fully overridden via datapacks. See Data-Driven Registries for details on adding custom blocks.</p>"},{"location":"blocks-and-scoring/#in-game-configuration","title":"In-Game Configuration","text":"<p>Scoring-related parameters are adjustable via the in-game GUI (requires Mod Menu + Cloth Config):</p> Setting Range Default What it controls Spawn Suppression 1\u201310 5 Adjusts both spawn thresholds together \u2014 higher values make it easier to reach full protection Detection Range 112\u2013496 blocks 240 blocks Size of the area evaluated around each spawn point (also affects sonar scan radius) <p>Advanced: civil.properties</p> <p>Raw parameters can also be edited in <code>config/civil.properties</code>, but this is intended for advanced users only. If things break, delete <code>civil.properties</code> and restart \u2014 the mod will regenerate it with defaults.</p>"},{"location":"civilization-decay/","title":"Civilization Decay","text":"<p>Civilization protection is not permanent. The world remembers your presence \u2014 and notices your absence.</p>"},{"location":"civilization-decay/#how-decay-works","title":"How Decay Works","text":"<p>Each scored region tracks a presence time \u2014 the last time a player was nearby. When no player has visited for a while, protection begins to fade:</p> <ol> <li>Grace period \u2014 For the first 6 hours (default) after you leave, nothing changes. Full protection.</li> <li>Exponential decay \u2014 After the grace period, the outer zone scores decay exponentially. Borders shrink inward.</li> <li>Decay floor \u2014 Scores never drop below 25% (default) of their original value. A well-built city retains meaningful core protection indefinitely.</li> </ol> <p>The decay only affects the outer zone of your civilization. The core \u2014 the densely built heart of your settlement \u2014 holds firm even after prolonged absence.</p>"},{"location":"civilization-decay/#recovery","title":"Recovery","text":"<p>Return to a decayed settlement and spend time there, and it recovers. Recovery is gradual:</p> <ul> <li>Recovery happens in steps, each advancing the presence time toward \"now\"</li> <li>Each step recovers a fraction of the gap between your last recorded presence and the current time (default 20%)</li> <li>Steps are rate-limited (default once per minute) to prevent instant restoration</li> <li>Don't worry about how long you've been away \u2014 restoration won't take too long, the city responds to you</li> </ul> <p>You don't need to do anything special \u2014 just being in the area is enough. Build, explore, craft \u2014 your presence is what matters.</p>"},{"location":"civilization-decay/#offline-time","title":"Offline Time","text":"<p>In singleplayer, offline time does not count as absence. The server clock only advances while the game is running. Close the game on Monday, open it on Friday \u2014 your civilization is exactly where you left it.</p> <p>In multiplayer, the server keeps running, so the clock keeps ticking. If no player visits a settlement, it will gradually decay according to the rules above.</p>"},{"location":"civilization-decay/#in-game-configuration","title":"In-Game Configuration","text":"<p>All decay parameters are adjustable via the in-game GUI (requires Mod Menu + Cloth Config):</p> Setting Range Default What it controls Freshness Duration 1\u201348 hours 6 hours Grace period before decay begins Decay Speed 1\u201310 5 How fast outer scores fade (higher = faster) Decay Floor 0\u201350% 25% Minimum retained score after full decay Recovery Speed 1\u201310 5 How quickly protection returns when you're nearby Patrol Influence Range 32\u2013128 blocks 64 blocks How far your presence sustains and restores settlements <p>Advanced: civil.properties</p> <p>Raw parameters can also be edited in <code>config/civil.properties</code>, but this is intended for advanced users only. The file contains many internal parameters that interact in non-obvious ways. If things break, delete <code>civil.properties</code> and restart \u2014 the mod will regenerate it with defaults.</p>"},{"location":"configuration/","title":"Configuration","text":"<p>Civillis works out of the box with no configuration required. Every parameter has a carefully tuned default. This page covers the two ways to customize behavior: the in-game GUI and the raw properties file.</p>"},{"location":"configuration/#singleplayer-vs-multiplayer-scope","title":"Singleplayer vs Multiplayer Scope","text":"<p>Civilization logic is server-authoritative. In multiplayer, gameplay-impacting settings are not per-player.</p> <ul> <li>Singleplayer / LAN host: the local config screen changes the same process that runs world logic, so changes affect gameplay immediately.</li> <li>Dedicated server: server-side <code>civil.properties</code> is the source of truth for civilization scoring, spawn suppression, decay, head attraction, and mob flee behavior.</li> <li>Client-only changes on a dedicated server: changing local GUI options does not override server logic.</li> </ul>"},{"location":"configuration/#in-game-gui","title":"In-Game GUI","text":"<p>Install Mod Menu + Cloth Config, then open the Civillis settings screen from the mod list.</p> <p>Settings are organized into one top-level category (Civilization) with two expandable subcategories.</p>"},{"location":"configuration/#main","title":"Main","text":"Setting Type Range Default Description Spawn Suppression Strength Slider 1\u201310 5 How strongly buildings suppress hostile mob spawning. Higher values lower both spawn thresholds, making it easier to reach full protection Detection Range Slider 112\u2013496 blocks (step 32) 240 blocks Size of the area scanned around each spawn attempt for nearby civilization. Also determines the sonar scan radius Detector Sonar Toggle on / off on Whether the Civilization Detector's sonar effects (boundary walls, shockwave particles, sounds) are enabled. Disabling keeps only the basic color/sound feedback"},{"location":"configuration/#decay-recovery-details","title":"Decay &amp; Recovery Details","text":"<p>Controls how protection fades when you leave and recovers when you return. See Civilization Decay for mechanics.</p> Setting Type Range Default Description Freshness Duration Slider 1\u201348 hours 6 hours Grace period before protection starts fading after your last visit Decay Speed Slider 1\u201310 5 How fast protection fades after the grace period expires. The slider label shows the approximate half-life Decay Floor Slider 0\u201350% 25% Minimum remaining protection even if fully abandoned. At 0% a settlement can decay to nothing; at 50% half the score always remains Recovery Speed Slider 1\u201310 5 How fast protection recovers when you return. The slider label shows the approximate recovery time Patrol Influence Range Slider 2\u20138 VC (32\u2013128 blocks) 4 VC (64 blocks) How far your presence refreshes nearby shards. Larger values let you restore a wider area by walking through it"},{"location":"configuration/#mob-head-attraction","title":"Mob Head Attraction","text":"<p>Controls how monster skulls attract and redirect spawns. See Monster Heads for mechanics.</p> Setting Type Range Default Description Attraction Strength Slider 1\u201310 5 How strongly skulls suppress distant spawns, concentrating mobs near the heads Attraction Range Slider 48\u2013160 blocks (step 16) 128 blocks Maximum horizontal radius within which skulls exert their redirection effect"},{"location":"configuration/#mob-flee-behavior","title":"Mob Flee Behavior","text":"<p>Controls whether hostile mobs retreat from civilized zones after spawning.</p> Setting Type Range Default Description Mob Flee AI Toggle on / off on Enables hostile-mob retreat behavior in civilized areas. In highly civilized city centers, mobs may panic and disengage from combat to escape"},{"location":"configuration/#civilproperties","title":"civil.properties","text":"<p>For fine-grained control, you can edit <code>config/civil.properties</code> directly. The file is auto-generated on first launch with all values commented out \u2014 the mod uses the GUI-derived internal values unless a raw override is present.</p> <p>Advanced Users Only</p> <p>Raw parameters bypass the GUI's safety mapping. If things break, delete <code>civil.properties</code> and restart \u2014 the mod will regenerate it with defaults. Changing a GUI slider will overwrite any raw override for the corresponding parameter.</p>"},{"location":"configuration/#file-location","title":"File Location","text":"<ul> <li>Production: <code>.minecraft/config/civil.properties</code></li> <li>Dev environment: <code>run/config/civil.properties</code></li> </ul>"},{"location":"configuration/#parameter-reference","title":"Parameter Reference","text":"<p>Below is the full list of raw parameters. Values shown are defaults derived from GUI defaults. All are normally commented out; uncomment to override.</p>"},{"location":"configuration/#spawn-thresholds","title":"Spawn Thresholds","text":"Key Type Default Description <code>spawn.thresholdLow</code> double ~0.14 Civilization score below which spawns are fully allowed <code>spawn.thresholdMid</code> double ~0.41 Score above which spawns are fully blocked. Between low and mid, suppression is probabilistic"},{"location":"configuration/#scoring-curve","title":"Scoring Curve","text":"Key Type Default Description <code>scoring.sigmoidMid</code> double 0.8 Sigmoid midpoint for the score normalization curve <code>scoring.sigmoidSteepness</code> double 3.0 Sigmoid steepness \u2014 higher values create a sharper transition <code>scoring.distanceAlphaSq</code> double 0.5 Distance weighting factor (squared) for blocks farther from the spawn point <code>scoring.normalizationFactor</code> double 5.0 Per-voxel-chunk score cap \u2014 a chunk's total block weight is divided by this value and clamped to 1.0. When the sum of block weights in a single 16\u00b3 chunk reaches 5.0, the chunk score is maxed out"},{"location":"configuration/#detection-ranges-voxel-chunks","title":"Detection Ranges (Voxel Chunks)","text":"Key Type Default Description <code>range.detectionRadiusX</code> int 7 Detection radius along X in voxel chunks (7 VC = 112 blocks per side \u2192 240 block box) <code>range.detectionRadiusZ</code> int 7 Detection radius along Z <code>range.detectionRadiusY</code> int 1 Detection radius along Y (vertical) <code>range.coreRadiusX</code> int 1 Core (inner zone) radius X <code>range.coreRadiusZ</code> int 1 Core radius Z <code>range.coreRadiusY</code> int 0 Core radius Y <code>range.headRangeX</code> int 1 Mob head bypass zone radius X <code>range.headRangeZ</code> int 1 Head bypass zone radius Z <code>range.headRangeY</code> int 0 Head bypass zone radius Y"},{"location":"configuration/#decay","title":"Decay","text":"Key Type Default Description <code>decay.gracePeriodHours</code> double 6.0 Hours before decay begins after your last visit <code>decay.lambda</code> double ~0.008 Exponential decay rate; half-life \u2248 ln(2) / \u03bb hours <code>decay.minFloor</code> double 0.25 Minimum score fraction retained after full decay (0.0\u20131.0)"},{"location":"configuration/#recovery","title":"Recovery","text":"Key Type Default Description <code>recovery.cooldownMs</code> long ~60000 Minimum milliseconds between recovery steps <code>recovery.fraction</code> double ~0.20 Fraction of the gap recovered per step <code>recovery.minMs</code> long ~2266666 Minimum recovery jump per step (ms). Each recovery step advances presenceTime by at least this amount, preventing the final stretch from dragging out when the remaining gap is small"},{"location":"configuration/#head-attraction","title":"Head Attraction","text":"Key Type Default Description <code>headAttract.enabled</code> boolean true Master switch for the head attraction system <code>headAttract.nearBlocks</code> double 32.0 Distance (blocks) within which skulls never suppress spawns <code>headAttract.maxRadius</code> double 128.0 Maximum horizontal attraction radius in blocks <code>headAttract.lambda</code> double 0.15 Attraction decay rate \u2014 higher values concentrate mobs more tightly around skulls"},{"location":"configuration/#mob-flee-ai","title":"Mob Flee AI","text":"Key Type Default Description <code>mobFlee.enabled</code> boolean true Master switch for flee behavior in civilized areas <code>mobFlee.combatFleeRatio</code> double 0.5 Fraction of the high-pressure interval where combat panic begins <code>mobFlee.checkIntervalTicks</code> int 80 Base interval between flee evaluations per mob (ticks) <code>mobFlee.jitterTicks</code> int 40 Random jitter added to evaluation interval for desynchronization <code>mobFlee.panicDurationTicks</code> int 80 Maximum duration of combat panic bursts (ticks) <code>mobFlee.maxDurationTicks</code> int 200 Maximum duration of non-combat flee movement (ticks) <code>mobFlee.speed</code> double 1.0 Movement speed multiplier while fleeing <code>mobFlee.sampleDistance</code> int 14 Sampling distance (blocks) used to choose flee direction"},{"location":"configuration/#cache-performance","title":"Cache &amp; Performance","text":"Key Type Default Description <code>cache.l1TtlMs</code> long 300000 L1 voxel chunk score TTL in milliseconds (5 min) <code>cache.resultTtlMs</code> long 3600000 Result shard TTL in milliseconds (60 min) <code>cache.clockPersistTicks</code> int 6000 How often the server clock is persisted to H2 (in ticks)"},{"location":"configuration/#detector-ui","title":"Detector &amp; UI","text":"Key Type Default Description <code>ui.detectorAnimationTicks</code> int 40 Sonar pulse animation length in ticks (2 seconds) <code>ui.detectorCooldownTicks</code> int 10 Cooldown between detector uses in ticks"},{"location":"configuration/#diagnostics","title":"Diagnostics","text":"Key Type Default Description <code>tpsLog.enabled</code> boolean true Whether TPS/MSPT is periodically logged to <code>latest.log</code>. Only effective when the mod's internal DEBUG flag is also enabled \u2014 in production builds this has no effect regardless of the setting <code>tpsLog.intervalTicks</code> int 20 Interval between TPS log entries in server ticks (~1 second). Same DEBUG requirement as above"},{"location":"detector/","title":"Civilization Detector","text":"<p>The Civilization Detector is a handheld tool that lets you scan and visualize your civilization level.</p>"},{"location":"detector/#crafting","title":"Crafting","text":"<p>Surround a compass with 8 emeralds in a crafting table:</p> <pre><code>E E E\nE C E\nE E E\n</code></pre> <p>Where E = Emerald, C = Compass.</p>"},{"location":"detector/#basic-use","title":"Basic Use","text":"<p>Right-click to scan. The detector reads the civilization score at your position and gives immediate feedback:</p> Color Meaning What it tells you \ud83d\udfe2 Green HIGH Fully protected \u2014 hostile spawns are blocked here \ud83d\udfe1 Yellow MID Partially protected \u2014 some spawns may get through \ud83d\udd34 Red LOW Unprotected wilderness \u2014 spawns proceed normally \ud83d\udfe3 Purple MONSTER Inside a monster head zone \u2014 skulls are active here <p>Each reading plays a distinct sound cue, so you can tell the result without looking at the item.</p> <p>The detector has a brief enchantment glint while the reading is active (~2 seconds).</p>"},{"location":"detector/#sonar-pulse","title":"Sonar Pulse","text":"<p>When the aura effect is enabled (on by default), right-clicking also fires a sonar pulse:</p>"},{"location":"detector/#charge-up","title":"Charge-Up","text":"<p>A vertical column of particles appears at your position for ~0.4 seconds, accompanied by a charge-up tone. The particle color reflects your current zone:</p> <ul> <li>White sparks (End Rod) \u2014 you're in a protected area</li> <li>Blue flames (Soul Fire) \u2014 you're in wilderness</li> <li>Orange flames (Fire) \u2014 you're in a head zone</li> </ul>"},{"location":"detector/#expanding-shockwave","title":"Expanding Shockwave","text":"<p>After the charge-up, a ring of particles expands outward from your position over ~1.5 seconds, reaching up to 120 blocks. Each particle is colored by the zone it passes through, painting the landscape with civilization data.</p> <p>A boom sound (breeze shoot) plays as the wave launches.</p>"},{"location":"detector/#boundary-walls","title":"Boundary Walls","text":"<p>~1.2 seconds after the scan, glowing translucent walls rise at the boundaries of your civilization:</p> <ul> <li>Gold/amber walls \u2014 civilization boundaries (where protection ends and wilderness begins)</li> <li>Amethyst/purple walls \u2014 monster head zone boundaries</li> </ul> <p>Walls appear with a fade-in, hold steady for ~2.5 seconds, then gently fade out over ~2 seconds. Firing the detector again while walls are visible extends their duration \u2014 and if you've moved toward a boundary, newly discovered faces appear while existing ones hold steady.</p> <p>Wall height spans \u00b148 blocks from the scan center.</p>"},{"location":"detector/#configuration","title":"Configuration","text":"<p>The sonar effect can be toggled on or off in the settings GUI. When disabled, the detector still provides color and sound feedback \u2014 just without the visual pulse and walls.</p>"},{"location":"how-it-works/","title":"How It Works","text":"<p>Civillis suppresses hostile mob spawning near player-built structures by computing a real-time civilization score for every location in the world.</p>"},{"location":"how-it-works/#the-basics","title":"The Basics","text":"<p>Every time a hostile mob attempts to spawn naturally, Civillis evaluates the area around that spawn point:</p> <ol> <li>Scan \u2014 A 240\u00d7240\u00d748 block area (configurable) is checked for blocks that signal human presence</li> <li>Score \u2014 Each recognized block contributes a weighted value to its local 16\u00b3 voxel chunk; all chunks in range are then aggregated into a final score between 0 and 1</li> <li>Decide \u2014 The score determines the spawn outcome</li> </ol> <p>This means millions of blocks evaluated per spawn attempt, across every spawn attempt in the world. See Architecture to learn how the shard-based civilization engine keeps this at constant time.</p>"},{"location":"how-it-works/#spawn-decisions","title":"Spawn Decisions","text":"<p>The civilization score maps to one of three outcomes:</p> <ul> <li>LOW (score below suppression threshold) \u2014 Spawn proceeds normally. This is wilderness.</li> <li>MID (score between low and high thresholds) \u2014 Spawn is probabilistically blocked. The higher the score, the more likely the block. This is the frontier.</li> <li>HIGH (score at or above suppression threshold) \u2014 Spawn is fully blocked. This is civilization.</li> </ul> <p>The in-game \"Spawn Suppression\" strength slider (1\u201310) adjusts both thresholds together \u2014 a higher value makes it easier to reach full protection with fewer blocks.</p>"},{"location":"how-it-works/#detection-range","title":"Detection Range","text":"<p>The detection area is centered on the spawn point, not the player. Default size is 240\u00d7240\u00d748 blocks (15\u00d715\u00d73 voxel chunks). This can be adjusted from 112 to 496 blocks per side in the settings.</p> <p>A larger detection range means distant builds contribute to the score \u2014 your city's outskirts help protect the center. A smaller range makes protection more localized.</p> <p>The Y-axis range is fixed at 48 blocks (3 voxel chunks), so builds above or below your location have limited influence.</p>"},{"location":"how-it-works/#what-counts-as-civilization","title":"What Counts as Civilization","text":"<p>Blocks that reflect human presence contribute to the score. The more complex or significant the block, the higher its weight:</p> <ul> <li>Stone Age (0.2\u20130.3) \u2014 Crafting tables, furnaces, chests, farmland</li> <li>Iron Age (0.4\u20130.5) \u2014 Lanterns, workstations (smithing, fletching, cartography, etc.)</li> <li>Advanced (0.7\u20131.0) \u2014 Beds, anvils, brewing stands, sea lanterns</li> <li>Mythic (2.0\u20135.0) \u2014 Respawn anchors, enchanting tables, beacons, conduits</li> </ul> <p>Light-emitting and magical blocks receive a bonus multiplier. See Blocks &amp; Scoring for the full weight table.</p> <p>Voxel Chunk Score Cap</p> <p>Each 16\u00d716\u00d716 voxel chunk has a maximum civilization score. Stacking more blocks into a single chunk beyond the cap doesn't help \u2014 spread your builds outward instead. A wider settlement actually provides bonus protection beyond what the individual blocks alone would suggest.</p>"},{"location":"how-it-works/#practical-scale","title":"Practical Scale","text":"<ul> <li>A small cabin with a crafting table, furnace, bed, and chest provides modest protection \u2014 mobs are less likely to spawn nearby, but not fully suppressed.</li> <li>A well-developed village with workstations, campfires, and lanterns pushes monsters back ~40 blocks from its borders.</li> <li>A sprawling industrial megacity \u2014 every chunk saturated with high-value blocks \u2014 can reach up to ~90 blocks of spawn-free perimeter. This requires serious dedication.</li> </ul>"},{"location":"how-it-works/#beyond-scoring","title":"Beyond Scoring","text":"<p>Civilization scoring is the foundation, but the mod doesn't stop there:</p> <ul> <li>Civilization Decay \u2014 Protection fades from the edges inward when you leave. Return and stay, and it recovers.</li> <li>Monster Heads \u2014 Skulls punch through civilization protection and redirect distant hostiles toward themselves.</li> <li>Mob Flee AI \u2014 Existing hostiles can retreat from civilization pressure, especially in dense city cores.</li> <li>Civilization Detector \u2014 Scan and visualize your civilization boundaries in real time.</li> </ul>"},{"location":"mob-flee-ai/","title":"Mob Flee AI","text":"<p>Mob Flee AI makes hostile mobs behave more naturally inside civilized areas: instead of only being blocked at spawn time, existing mobs can also decide to retreat.</p>"},{"location":"mob-flee-ai/#what-it-does","title":"What It Does","text":"<p>When enabled, hostile mobs periodically evaluate the local civilization level and may choose to flee toward less civilized ground.</p> <ul> <li>In moderately civilized areas, mobs tend to disengage and drift outward</li> <li>In highly civilized city centers, mobs can panic and may even give up fighting to escape</li> <li>This behavior is linked to your Spawn Suppression tuning, so stronger suppression generally means stronger flee pressure</li> </ul> <p>This gives settlements a more believable defensive atmosphere: danger does not just fail to appear, it also struggles to stay.</p>"},{"location":"mob-flee-ai/#two-flee-modes","title":"Two Flee Modes","text":"<p>Mob Flee AI uses two behavior modes:</p> <ul> <li>Idle flee \u2014 normal retreat movement when civilization pressure is present</li> <li>Combat panic \u2014 short panic bursts in very high-pressure zones, including potential mid-combat disengagement</li> </ul> <p>Both modes are controlled by the same underlying civilization score, but with different thresholds and durations.</p>"},{"location":"mob-flee-ai/#how-direction-is-chosen","title":"How Direction Is Chosen","text":"<p>The flee goal samples multiple candidate directions around the mob and compares civilization pressure in each direction. It then prefers routes that move the mob toward lower-pressure space.</p> <p>In practice, this means:</p> <ul> <li>mobs near borders tend to leak outward first</li> <li>mobs deep in dense city interiors react more aggressively</li> <li>movement still respects normal pathfinding constraints</li> </ul>"},{"location":"mob-flee-ai/#relationship-to-spawn-suppression","title":"Relationship to Spawn Suppression","text":"<p>Mob Flee AI is a behavior layer, not a replacement for spawn suppression:</p> <ul> <li>Spawn suppression controls whether new hostile mobs are allowed to spawn</li> <li>Mob flee AI controls how already-present hostile mobs behave after spawning</li> </ul> <p>Together, they produce a smoother \"civilized territory\" feeling:</p> <ol> <li>New hostile spawns are reduced or blocked</li> <li>Existing hostiles are encouraged to retreat</li> </ol>"},{"location":"mob-flee-ai/#configuration","title":"Configuration","text":""},{"location":"mob-flee-ai/#in-game-gui","title":"In-Game GUI","text":"<p><code>Civillis Settings</code> \u2192 <code>Civilization</code> \u2192 <code>Mob Flee Behavior</code></p> <ul> <li>Mob Flee AI (toggle): enables/disables flee behavior globally</li> </ul>"},{"location":"mob-flee-ai/#advanced-civilproperties","title":"Advanced <code>civil.properties</code>","text":"<p>You can tune deeper behavior with raw parameters:</p> <ul> <li><code>mobFlee.enabled</code></li> <li><code>mobFlee.combatFleeRatio</code></li> <li><code>mobFlee.checkIntervalTicks</code></li> <li><code>mobFlee.jitterTicks</code></li> <li><code>mobFlee.panicDurationTicks</code></li> <li><code>mobFlee.maxDurationTicks</code></li> <li><code>mobFlee.speed</code></li> <li><code>mobFlee.sampleDistance</code></li> </ul> <p>See Configuration for parameter details.</p>"},{"location":"monster-heads/","title":"Monster Heads","text":"<p>Monster skulls are the counterpart to civilization. Where civilization blocks push monsters away, skulls invite them back \u2014 on your terms.</p>"},{"location":"monster-heads/#three-mechanisms","title":"Three Mechanisms","text":"<p>Monster heads operate through three distinct systems, each activating at a different scale:</p>"},{"location":"monster-heads/#1-spawn-gate-bypass","title":"1. Spawn Gate Bypass","text":"<p>Place a monster skull and it creates a 48\u00d748\u00d716 block zone (3\u00d73\u00d71 voxel chunks) around itself where civilization protection is completely bypassed. Mobs can spawn freely inside this zone regardless of the civilization score.</p> <p>This is a local, unconditional override \u2014 the skull punches straight through the spawn gate.</p>"},{"location":"monster-heads/#2-distant-spawn-redirection","title":"2. Distant Spawn Redirection","text":"<p>Beyond the local bypass zone, skulls exert a range-bounded attraction effect. When a hostile mob attempts to spawn outside the local skull zone, the mod may suppress that spawn based on:</p> <ul> <li>Distance \u2014 The closer the spawn is to a skull, the less likely it is to be suppressed. Spawns very close to a skull are never suppressed.</li> <li>Head count in range \u2014 More skulls within the active attraction window increase suppression strength. Scaling is logarithmic, so returns diminish as count grows.</li> <li>Max radius \u2014 Attraction only operates within a configurable horizontal radius (default 128 blocks). Skulls outside this radius do not contribute.</li> </ul> <p>The net effect: eligible distant spawns are probabilistically cancelled, concentrating mob spawns near your skulls. This is what makes skulls useful for mob farms \u2014 you don't need to light up caves or build in the sky. Just place skulls where you want the mobs.</p>"},{"location":"monster-heads/#3-mob-conversion","title":"3. Mob Conversion","text":"<p>When 3 or more skulls are clustered in the same voxel chunk area, they begin converting spawned mobs into matching types:</p> Skulls in area Conversion chance 1\u20132 No conversion (local bypass only) 3 ~12.5% 5 ~37.5% 7 ~62.5% 10+ 100% <p>Conversion picks a random type from the skulls present. Place 3 skeleton skulls and some spawns will convert to skeletons. Mix skeleton and zombie skulls for a blend. The more skulls, the stronger the conversion.</p> <p>Dimension Restrictions</p> <p>Some skull types are restricted to specific dimensions. By default, Wither Skeleton Skulls and Piglin Heads only function in the Nether \u2014 all three mechanisms (bypass, redirection, and conversion) are inactive outside their designated dimensions. In non-matching dimensions, restricted skulls are purely decorative.</p> <p>Modpack authors can customize which dimensions each skull type operates in via the <code>\"dimensions\"</code> field in datapack JSON \u2014 see Data-Driven Registries.</p>"},{"location":"monster-heads/#skull-types","title":"Skull Types","text":"<p>Head types are data-driven. The default registry ships with all vanilla skull types:</p> Skull Attracts Converts Active Dimensions Skeleton Skull Skeleton Yes All Zombie Head Zombie Yes All Creeper Head Creeper Yes All Piglin Head Piglin Yes Nether only Wither Skeleton Skull Wither Skeleton Yes Nether only <p>Dimension-restricted skulls are purely decorative outside their designated dimensions \u2014 bypass, redirection, and conversion are all inactive.</p> <p>Custom skull types added by other mods via <code>SkullBlock</code> subclasses are automatically compatible. Head types can be configured, disabled, or extended via datapacks \u2014 see Data-Driven Registries.</p>"},{"location":"monster-heads/#in-game-configuration","title":"In-Game Configuration","text":"<p>Head attraction parameters are adjustable via the in-game GUI under the \"Head Attraction\" subcategory (requires Mod Menu + Cloth Config):</p> Setting Range Default What it controls Attraction Strength 1\u201310 5 How strongly skulls suppress distant spawns Attraction Range 48\u2013160 blocks 128 blocks Maximum horizontal radius for redirection <p>Advanced: civil.properties</p> <p>Raw parameters can also be edited in <code>config/civil.properties</code>, but this is intended for advanced users only. If things break, delete <code>civil.properties</code> and restart \u2014 the mod will regenerate it with defaults.</p>"},{"location":"modpack/compatibility/","title":"Built-in Compatibility","text":"<p>Civillis ships with built-in civilization block weights for several popular mods. These are included as standard datapack JSON files \u2014 if the mod is installed, its blocks contribute to civilization scoring automatically. If the mod is absent, the entries are silently skipped at load time.</p> <p>No configuration needed. Just install both mods and it works.</p>"},{"location":"modpack/compatibility/#farmers-delight","title":"Farmer's Delight","text":"<p>Functional kitchen and storage blocks that represent a thriving settlement. 5 entries, weights 0.3\u20130.5.</p> View all blocks Block Weight Stove 0.5 Cooking Pot 0.5 Cabinets (all 11 wood types) 0.4 Cutting Board 0.3 Basket 0.3"},{"location":"modpack/compatibility/#supplementaries","title":"Supplementaries","text":"<p>Decorative and functional blocks spanning multiple material tiers. 46 entries, weights 0.2\u20130.8.</p> View all blocks <p>Advanced tier (0.7\u20130.8)</p> Block Weight Netherite Door 0.8 Netherite Trapdoor 0.7 Cannon 0.7 <p>Iron\u2013Advanced tier (0.4\u20130.5)</p> Block Weight Safe 0.5 Globe / Globe (Sepia) 0.5 Hourglass 0.5 Gold Door 0.5 End Stone Lamp 0.5 Gold Trapdoor / Gold Gate 0.4 Clock Block 0.4 Pulley Block 0.4 Stone / Blackstone / Deepslate Lamp 0.4 Fire Pit 0.4 Goblet 0.4 Iron Gate 0.4 Cog Block 0.4 <p>Iron tier (0.3)</p> Block Weight Sconce / Soul Sconce / Green Sconce / Sconce Lever 0.3 Pedestal 0.3 Statue 0.3 Notice Board 0.3 Bellows 0.3 Wind Vane 0.3 Turn Table 0.3 Speaker Block 0.3 Faucet 0.3 Crystal Display 0.3 <p>Stone Age (0.2)</p> Block Weight Jar 0.2 Cage 0.2 Flower Box 0.2 Item Shelf 0.2 Blackboard 0.2 Planter 0.2 Book Pile / Book Pile (Horizontal) 0.2 Doormat 0.2"},{"location":"modpack/compatibility/#create","title":"Create","text":"<p>Mechanical and industrial blocks, weighted by Create's own material tier system. 63 entries, weights 0.3\u20131.0.</p> View all blocks <p>Precision tier (0.8\u20131.0)</p> Block Weight Steam Engine 1.0 Mechanical Crafter 0.9 Blaze Burner 0.8 Deployer 0.8 Mechanical Arm 0.8 <p>Brass tier (0.6\u20130.7)</p> Block Weight Clockwork Bearing 0.7 Sequenced Gearshift 0.7 Rotation Speed Controller 0.6 Schematicannon 0.6 Track Station 0.6 Elevator Pulley 0.6 <p>Andesite tier (0.4\u20130.5)</p> Block Weight Mechanical Press 0.5 Mechanical Mixer 0.5 Mechanical Saw 0.5 Mechanical Drill 0.5 Crushing Wheel 0.5 Basin 0.5 Millstone 0.5 Encased Fan 0.5 Spout 0.5 Mechanical Pump 0.5 Hose Pulley 0.5 Flywheel 0.5 Mechanical Bearing 0.5 Nixie Tube 0.5 Cuckoo Clock 0.5 Display Link 0.5 Rose Quartz Lamp 0.5 Peculiar Bell 0.5 Haunted Bell 0.5 Water Wheel 0.4 Large Water Wheel 0.4 Windmill Bearing 0.4 Fluid Tank 0.4 Item Vault 0.4 Depot 0.4 Item Drain 0.4 Mechanical Piston / Sticky Mechanical Piston 0.4 Brass Funnel / Brass Tunnel 0.4 Smart Chute 0.4 Mechanical Harvester 0.4 Mechanical Plough 0.4 Weighted Ejector 0.4 Redstone Link 0.4 Flap Display 0.4 Steam Whistle 0.4 <p>Basic tier (0.3)</p> Block Weight Hand Crank 0.3 Andesite Funnel 0.3 Chute 0.3 Gearbox 0.3 Schematic Table 0.3 Placard 0.3 Desk Bell 0.3 Clipboard 0.3"},{"location":"modpack/compatibility/#how-it-works","title":"How It Works","text":"<p>Compatibility files are standard <code>civil_blocks</code> JSON located at:</p> <pre><code>data/civil/civil_blocks/compat_farmersdelight.json\ndata/civil/civil_blocks/compat_supplementaries.json\ndata/civil/civil_blocks/compat_create.json\n</code></pre> <p>The block weight loader resolves each block ID against the game registry at load time. If the mod isn't installed, <code>Registries.BLOCK.containsId()</code> returns false and the entry is skipped with a debug log warning. There is no mod-presence check \u2014 it's simply \"if the block exists, register its weight.\"</p> <p>This means:</p> <ul> <li>Zero overhead when the mod is absent</li> <li>Automatic activation when the mod is present</li> <li>Fully overridable via your own datapack \u2014 just create entries for the same block IDs with your preferred weights</li> </ul>"},{"location":"modpack/compatibility/#adding-support-for-other-mods","title":"Adding Support for Other Mods","text":"<p>If you use a mod not listed here, you can add civilization weights yourself via a datapack. See Data-Driven Registries for the full JSON format and examples.</p> <p>We welcome pull requests adding compatibility files for popular mods \u2014 follow the weight framework in Blocks &amp; Scoring and submit to the GitHub repository.</p>"},{"location":"modpack/data-driven/","title":"Data-Driven Registries","text":"<p>Civillis uses two data-driven registries that can be fully customized via datapacks:</p> <ul> <li>Block Weights (<code>civil_blocks</code>) \u2014 which blocks count as civilization and how much they contribute</li> <li>Head Types (<code>civil_heads</code>) \u2014 which skull types are recognized and what mobs they map to</li> </ul> <p>Both follow the same pattern: JSON files placed under <code>data/&lt;namespace&gt;/&lt;registry&gt;/</code> are loaded at server startup and on <code>/reload</code>. No mod code changes needed \u2014 just drop JSON into your datapack.</p>"},{"location":"modpack/data-driven/#block-weights","title":"Block Weights","text":"<p>The block weight registry determines which blocks are recognized as civilization and how much each one contributes to the per-voxel-chunk score. A higher weight means stronger spawn suppression. Weights follow a progression from Stone Age basics (0.2\u20130.3) to Mythic landmarks (2.0\u20135.0) \u2014 see Blocks &amp; Scoring for the full weight framework and vanilla block table.</p>"},{"location":"modpack/data-driven/#file-location","title":"File Location","text":"<pre><code>data/&lt;namespace&gt;/civil_blocks/&lt;any_name&gt;.json\n</code></pre> <p>Files are discovered by scanning all namespaces for JSON under <code>civil_blocks/</code>. You can use any namespace (your modpack ID, <code>civil</code>, or anything else).</p>"},{"location":"modpack/data-driven/#json-format","title":"JSON Format","text":"<pre><code>{\n  \"replace\": false,\n  \"entries\": [\n    { \"block\": \"minecraft:beacon\", \"weight\": 5.0 },\n    { \"block\": \"#minecraft:beds\", \"weight\": 0.7 },\n    { \"block\": \"mymod:fancy_lamp\", \"weight\": 0.6 }\n  ]\n}\n</code></pre> Field Required Description <code>replace</code> No If <code>true</code>, clears all previously loaded block weights before applying this file. Default <code>false</code> (merge) <code>entries</code> Yes Array of block weight definitions <code>entries[].block</code> Yes Block ID (<code>\"minecraft:beacon\"</code>) or block tag with <code>#</code> prefix (<code>\"#minecraft:beds\"</code>) <code>entries[].weight</code> Yes Civilization weight (typically 0.2\u20135.0). See Blocks &amp; Scoring for the weight framework"},{"location":"modpack/data-driven/#tag-support","title":"Tag Support","text":"<p>Prefix a block ID with <code>#</code> to target an entire block tag. For example, <code>\"#minecraft:beds\"</code> assigns the weight to all bed variants (oak, spruce, birch, etc.) in one entry. Unknown tags are silently skipped.</p>"},{"location":"modpack/data-driven/#loading-order-overrides","title":"Loading Order &amp; Overrides","text":"<ul> <li>Files are processed in resource identifier order (namespace alphabetically, then path)</li> <li>Later entries for the same block override earlier ones</li> <li>A file with <code>\"replace\": true</code> clears all accumulated weights before applying its own entries \u2014 useful for modpacks that want a completely custom weight table</li> </ul>"},{"location":"modpack/data-driven/#examples","title":"Examples","text":"<p>Add blocks from a custom mod:</p> <pre><code>{\n  \"entries\": [\n    { \"block\": \"mymod:arcane_table\", \"weight\": 1.5 },\n    { \"block\": \"mymod:crystal_lamp\", \"weight\": 0.6 },\n    { \"block\": \"#mymod:workstations\", \"weight\": 0.5 }\n  ]\n}\n</code></pre> <p>Override a vanilla block's weight:</p> <pre><code>{\n  \"entries\": [\n    { \"block\": \"minecraft:beacon\", \"weight\": 10.0 }\n  ]\n}\n</code></pre> <p>Replace the entire weight table:</p> <pre><code>{\n  \"replace\": true,\n  \"entries\": [\n    { \"block\": \"minecraft:beacon\", \"weight\": 5.0 },\n    { \"block\": \"minecraft:enchanting_table\", \"weight\": 3.0 }\n  ]\n}\n</code></pre>"},{"location":"modpack/data-driven/#head-types","title":"Head Types","text":"<p>The head type registry controls which monster skulls are recognized by Civillis and maps each one to a mob entity. Recognized skulls activate three gameplay mechanisms: local spawn gate bypass, range-bounded spawn redirection, and mob conversion. See Monster Heads for how these mechanics work in detail.</p>"},{"location":"modpack/data-driven/#default-registry","title":"Default Registry","text":"Skull Type Entity Conversion Active Dimensions <code>SKELETON</code> <code>minecraft:skeleton</code> Yes All <code>ZOMBIE</code> <code>minecraft:zombie</code> Yes All <code>CREEPER</code> <code>minecraft:creeper</code> Yes All <code>PIGLIN</code> <code>minecraft:piglin</code> Yes Nether only <code>WITHER_SKELETON</code> <code>minecraft:wither_skeleton</code> Yes Nether only"},{"location":"modpack/data-driven/#file-location_1","title":"File Location","text":"<pre><code>data/&lt;namespace&gt;/civil_heads/&lt;any_name&gt;.json\n</code></pre>"},{"location":"modpack/data-driven/#json-format_1","title":"JSON Format","text":"<pre><code>{\n  \"replace\": false,\n  \"entries\": [\n    {\n      \"skull_type\": \"ZOMBIE\",\n      \"entity_type\": \"minecraft:zombie\"\n    },\n    {\n      \"skull_type\": \"WITHER_SKELETON\",\n      \"entity_type\": \"minecraft:wither_skeleton\",\n      \"dimensions\": [\"minecraft:the_nether\"]\n    },\n    {\n      \"skull_type\": \"BLAZE\",\n      \"entity_type\": \"minecraft:blaze\",\n      \"convert\": false,\n      \"dimensions\": [\"minecraft:the_nether\"]\n    }\n  ]\n}\n</code></pre> Field Required Description <code>replace</code> No If <code>true</code>, clears all previously loaded head types. Default <code>false</code> <code>entries</code> Yes Array of head type definitions <code>entries[].skull_type</code> Yes Must match <code>SkullBlock.SkullType.toString()</code> for vanilla, or a custom string for modded skulls <code>entries[].entity_type</code> No The mob entity this skull attracts/converts to. If omitted, the skull contributes to zone/range but has no mob mapping <code>entries[].enabled</code> No Master switch. <code>false</code> makes this skull type invisible to all gameplay systems. Default <code>true</code> <code>entries[].convert</code> No Whether this skull participates in the conversion pool. <code>false</code> means it still counts for bypass and redirection but never produces conversions. Default <code>true</code> <code>entries[].dimensions</code> No Array of dimension IDs where this skull type is active (e.g. <code>[\"minecraft:the_nether\"]</code>). If omitted, active in all dimensions. In non-matching dimensions the skull is purely decorative"},{"location":"modpack/data-driven/#override-disable","title":"Override &amp; Disable","text":"<p>Later entries for the same <code>skull_type</code> fully replace earlier ones. To disable a specific skull type without removing it:</p> <pre><code>{\n  \"entries\": [\n    { \"skull_type\": \"ZOMBIE\", \"enabled\": false }\n  ]\n}\n</code></pre>"},{"location":"modpack/data-driven/#modded-skull-types","title":"Modded Skull Types","text":"<p>Mods that add new skull types via custom <code>AbstractSkullBlock</code> subclasses (with custom <code>SkullType</code> enums) are automatically compatible. Register them by matching the <code>skull_type</code> string:</p> <pre><code>{\n  \"entries\": [\n    { \"skull_type\": \"BLAZE\", \"entity_type\": \"minecraft:blaze\" }\n  ]\n}\n</code></pre> <p>Player-texture heads not supported</p> <p>Mods that use <code>PLAYER</code> heads with custom textures (such as All The Heads, Just Mob Heads) are not supported \u2014 the system sees them all as skull type <code>PLAYER</code> and cannot distinguish which mob they represent. Only mods using distinct <code>SkullType</code> values are compatible.</p>"},{"location":"modpack/data-driven/#examples_1","title":"Examples","text":"<p>Restrict a skull to specific dimensions:</p> <pre><code>{\n  \"entries\": [\n    {\n      \"skull_type\": \"SKELETON\",\n      \"entity_type\": \"minecraft:skeleton\",\n      \"dimensions\": [\"minecraft:overworld\"]\n    }\n  ]\n}\n</code></pre> <p>Allow bypass and redirection but no conversion:</p> <pre><code>{\n  \"entries\": [\n    {\n      \"skull_type\": \"BLAZE\",\n      \"entity_type\": \"minecraft:blaze\",\n      \"convert\": false,\n      \"dimensions\": [\"minecraft:the_nether\"]\n    }\n  ]\n}\n</code></pre> <p>Replace the entire head type table:</p> <pre><code>{\n  \"replace\": true,\n  \"entries\": [\n    { \"skull_type\": \"SKELETON\", \"entity_type\": \"minecraft:skeleton\" },\n    { \"skull_type\": \"ZOMBIE\", \"entity_type\": \"minecraft:zombie\" }\n  ]\n}\n</code></pre> <p>Only skeleton and zombie skulls remain active. All other vanilla skulls become decorative.</p>"},{"location":"modpack/data-driven/#tips-for-modpack-authors","title":"Tips for Modpack Authors","text":"<ul> <li>Namespace your files \u2014 use your modpack's namespace (e.g. <code>data/mypack/civil_blocks/overrides.json</code>) to keep things organized and avoid conflicts with other datapacks</li> <li>Don't use <code>replace: true</code> unless you need a clean slate \u2014 it clears everything loaded before your file, including other datapacks</li> <li>Test with <code>/reload</code> \u2014 both registries reload live without a server restart. Check the server log for <code>[civil-registry]</code> messages confirming your entries loaded</li> <li>Unknown blocks are safe \u2014 if a block ID doesn't exist (mod not installed), the entry is silently skipped at load time with a log warning. No errors, no performance cost</li> </ul>"},{"location":"modpack/head-types/","title":"Head Type Registry","text":"<p>Coming soon.</p>"},{"location":"technical/architecture/","title":"Architecture Overview","text":"<p>This page illustrates how Civillis decides whether a hostile mob is allowed to spawn, and how the major systems \u2014 civilization scoring, decay, and monster heads \u2014 interact.</p>"},{"location":"technical/architecture/#spawn-decision-workflow","title":"Spawn Decision Workflow","text":"<p>Every time Minecraft's natural spawn cycle tries to place a hostile mob, Civillis intercepts and runs the following decision pipeline:</p> <pre><code>flowchart TD\n    SpawnAttempt[\"Hostile Mob Spawn Attempt\"]\n    NaturalCheck{Natural spawn?}\n    HeadQuery[\"Query nearby skulls\"]\n    HasNearby{Skulls in local zone?}\n    HeadNearby[\"HEAD_NEARBY: Allow spawn\"]\n    ConvertCheck{3+ skulls?}\n    ConvertMob[\"Roll conversion\"]\n    HeadAttract{Distant skull attraction?}\n    HeadSuppress[\"HEAD_SUPPRESS: Block spawn\"]\n    ScoreQuery[\"Query civilization score\"]\n    ApplyDecay[\"Apply decay factor\"]\n    ThresholdCheck{Score vs thresholds}\n    Allow[\"Allow spawn\"]\n    Probabilistic[\"Probabilistic block\"]\n    Block[\"Block spawn\"]\n\n    SpawnAttempt --&gt; NaturalCheck\n    NaturalCheck --&gt;|No: spawner / egg / summon| Allow\n    NaturalCheck --&gt;|Yes| HeadQuery\n    HeadQuery --&gt; HasNearby\n    HasNearby --&gt;|Yes| HeadNearby\n    HeadNearby --&gt; ConvertCheck\n    ConvertCheck --&gt;|Yes| ConvertMob\n    ConvertCheck --&gt;|No| Allow\n    ConvertMob --&gt; Allow\n    HasNearby --&gt;|No| HeadAttract\n    HeadAttract --&gt;|Suppressed by distant skulls| HeadSuppress\n    HeadAttract --&gt;|Not suppressed| ScoreQuery\n    ScoreQuery --&gt; ApplyDecay\n    ApplyDecay --&gt; ThresholdCheck\n    ThresholdCheck --&gt;|Below low threshold| Allow\n    ThresholdCheck --&gt;|Between thresholds| Probabilistic\n    ThresholdCheck --&gt;|Above mid threshold| Block</code></pre> <p>Non-natural spawns (spawn eggs, spawners, <code>/summon</code>, reinforcements) bypass the pipeline entirely and always succeed.</p>"},{"location":"technical/architecture/#civilization-score","title":"Civilization Score","text":"<p>The score represents how \"civilized\" an area is. It is computed once per detection area and then kept up to date incrementally:</p> <pre><code>flowchart TD\n    Blocks[\"Recognized blocks in world\"]\n    Palette{\"Target blocks in chunk palette?\"}\n    SkipChunk[\"Skip: score = 0\"]\n    Weight[\"Scan section, look up weight per block\"]\n    VCScore[\"Per-voxel-chunk score (capped at 1.0)\"]\n    Aggregate[\"Distance-weighted aggregation&lt;br/&gt;across all chunks in detection range\"]\n    Score[\"Cached civilization score\"]\n\n    Change[\"Block placed or broken\"]\n    Recompute[\"Recompute affected voxel chunk\"]\n    Delta[\"Delta = new score - old score\"]\n    DeltaZero{Delta = 0?}\n    Propagate[\"Apply delta \u00d7 distance coefficient&lt;br/&gt;to each overlapping cached result\"]\n\n    Blocks --&gt; Palette\n    Palette --&gt;|No| SkipChunk --&gt; VCScore\n    Palette --&gt;|Yes| Weight --&gt; VCScore\n    VCScore --&gt; Aggregate --&gt; Score\n\n    Change --&gt; Recompute --&gt; Delta --&gt; DeltaZero\n    DeltaZero --&gt;|Yes| Score\n    DeltaZero --&gt;|No| Propagate --&gt; Score</code></pre> <ul> <li>Each 16\u00b3 voxel chunk scores the weighted sum of recognized blocks inside it, capped at 1.0</li> <li>The detection range (default 240\u00d7240\u00d748 blocks) defines how many chunks are aggregated</li> <li>After the initial computation, block changes only recompute the single affected chunk and propagate the difference \u2014 the cached score is never fully recomputed</li> </ul>"},{"location":"technical/architecture/#decay-integration","title":"Decay Integration","text":"<p>Civilization protection is not permanent. The decay system modulates the outer-zone contribution of the civilization score based on player presence:</p> <pre><code>flowchart TD\n    ScoreComputed[\"Raw score computed\"]\n    SplitZones[\"Split: core zone + outer zone\"]\n    CoreScore[\"Core: always full strength\"]\n    OuterScore[\"Outer: modulated by decay\"]\n    PresenceCheck[\"When was this area last visited?\"]\n    GracePeriod{Within grace period?}\n    FullOuter[\"Outer: full strength\"]\n    DecayApply[\"Outer: exponential decay applied\"]\n    FloorCheck[\"Clamped to decay floor\"]\n    CombinedScore[\"Effective score = core + decayed outer\"]\n\n    ScoreComputed --&gt; SplitZones\n    SplitZones --&gt; CoreScore\n    SplitZones --&gt; OuterScore\n    OuterScore --&gt; PresenceCheck\n    PresenceCheck --&gt; GracePeriod\n    GracePeriod --&gt;|Yes| FullOuter\n    GracePeriod --&gt;|No| DecayApply\n    DecayApply --&gt; FloorCheck\n    FloorCheck --&gt; CombinedScore\n    FullOuter --&gt; CombinedScore\n    CoreScore --&gt; CombinedScore</code></pre> <p>When a player returns, their presence gradually advances the recorded visit time, restoring the outer zone contribution step by step.</p>"},{"location":"technical/architecture/#monster-head-interaction","title":"Monster Head Interaction","text":"<p>Monster heads operate on a separate pathway that runs before the civilization score is even consulted:</p> <pre><code>flowchart TD\n    SpawnPos[\"Spawn position\"]\n    ScanHeads[\"Query indexed skull buckets near spawn\"]\n    DimFilter[\"Filter by dimension whitelist\"]\n    LocalZone{Skulls within local zone?}\n    AllowSpawn[\"HEAD_NEARBY: Allow spawn\"]\n    CountHeads{\"3+ skulls clustered?\"}\n    NoConvert[\"Spawn original mob\"]\n    RollConvert[\"Roll conversion probability\"]\n    ConvertSuccess{Roll succeeds?}\n    SpawnConverted[\"Spawn as converted type\"]\n    SpawnOriginal[\"Spawn original mob\"]\n    DistantCalc[\"Evaluate heads within attraction window\"]\n    SuppressRoll{Suppression roll succeeds?}\n    BlockSpawn[\"HEAD_SUPPRESS: Block spawn\"]\n    ContinueToCiv[\"Continue to civilization scoring\"]\n\n    SpawnPos --&gt; ScanHeads --&gt; DimFilter --&gt; LocalZone\n    LocalZone --&gt;|Yes| AllowSpawn --&gt; CountHeads\n    CountHeads --&gt;|No| NoConvert\n    CountHeads --&gt;|Yes| RollConvert --&gt; ConvertSuccess\n    ConvertSuccess --&gt;|Yes| SpawnConverted\n    ConvertSuccess --&gt;|No| SpawnOriginal\n    LocalZone --&gt;|No| DistantCalc --&gt; SuppressRoll\n    SuppressRoll --&gt;|Yes| BlockSpawn\n    SuppressRoll --&gt;|No| ContinueToCiv</code></pre> <ul> <li>Skulls restricted to specific dimensions (e.g., wither skeleton skulls \u2192 Nether only) are filtered out before any mechanism activates</li> <li>Conversion probability scales with skull count; converted mobs bypass this pipeline on their own spawn to prevent recursion</li> <li>Distant suppression is range-bounded and index-backed: only heads in the local attraction window are considered</li> </ul>"},{"location":"technical/architecture/#mob-flee-behavior-layer","title":"Mob Flee Behavior Layer","text":"<p>Mob Flee AI runs as a post-spawn behavior layer for existing hostile mobs. It does not replace spawn gating; it complements it.</p> <ul> <li>Spawn gating decides whether a new hostile mob is allowed to appear</li> <li>Mob Flee AI decides whether an already-existing hostile mob should retreat from civilization pressure</li> </ul> <p>In dense city cores, flee logic may escalate to panic-like retreat behavior (including possible combat disengagement), while outer civilized zones usually produce softer outward drift.</p> <pre><code>flowchart TD\n    Tick[\"Periodic evaluation per mob\"]\n    Enabled{\"Mob Flee AI enabled?\"}\n    HeadZone{\"Inside local head force-allow zone?\"}\n    Score[\"Read local civilization score\"]\n    GreenLine[\"greenLine = spawnThresholdMid\"]\n    AboveGreen{score &gt;= greenLine?}\n    CombatLine[\"combatLine = greenLine + (1-greenLine) * combatFleeRatio\"]\n\n    ModeCheck{\"Current state\"}\n    IdleBranch[\"IDLE mode (no target)\"]\n    CombatBranch[\"COMBAT_PANIC mode (has target)\"]\n\n    IdleZone{score &lt; combatLine?}\n    IdleProb[\"P_idle = (score - greenLine) / (combatLine - greenLine)\"]\n    IdleRoll{\"Roll &lt; P_idle ?\"}\n    IdleForce[\"score &gt;= combatLine -&gt; guaranteed idle flee start\"]\n\n    CombatGate{score &gt;= combatLine?}\n    CombatProb[\"P_panic = ((score - combatLine)/(1-combatLine)) * (1-greenLine)\"]\n    CombatRoll{\"Roll &lt; P_panic ?\"}\n\n    FindTargetIdle[\"Choose flee target (idle)&lt;br/&gt;1) nearby head-zone target&lt;br/&gt;2) 8-direction gradient to lower score\"]\n    FindTargetPanic[\"Choose flee target (panic)&lt;br/&gt;1) nearby head-zone target&lt;br/&gt;2) 8-direction gradient to lower score\"]\n    StartIdle[\"Start IDLE flee\"]\n    StartPanic[\"Start COMBAT panic&lt;br/&gt;clear target, panic burst\"]\n    ContinueIdle[\"Continue normal AI (idle branch)\"]\n    ContinueCombat[\"Continue normal AI (combat branch)\"]\n    Continue[\"Continue normal AI\"]\n\n    Tick --&gt; Enabled\n    Enabled --&gt;|No| Continue\n    Enabled --&gt;|Yes| HeadZone\n    HeadZone --&gt;|Yes| Continue\n    HeadZone --&gt;|No| Score --&gt; GreenLine --&gt; AboveGreen\n    AboveGreen --&gt;|No| Continue\n    AboveGreen --&gt;|Yes| CombatLine --&gt; ModeCheck\n\n    ModeCheck --&gt;|No attack target| IdleBranch --&gt; IdleZone\n    IdleZone --&gt;|Yes| IdleProb --&gt; IdleRoll\n    IdleRoll --&gt;|No| ContinueIdle\n    IdleRoll --&gt;|Yes| FindTargetIdle --&gt; StartIdle\n    IdleZone --&gt;|No| IdleForce --&gt; FindTargetIdle\n\n    ModeCheck --&gt;|Has attack target| CombatBranch --&gt; CombatGate\n    CombatGate --&gt;|No| ContinueCombat\n    CombatGate --&gt;|Yes| CombatProb --&gt; CombatRoll\n    CombatRoll --&gt;|No| ContinueCombat\n    CombatRoll --&gt;|Yes| FindTargetPanic --&gt; StartPanic\n\n    ContinueIdle --&gt; Continue\n    ContinueCombat --&gt; Continue</code></pre>"},{"location":"technical/architecture/#registry-loading-injection","title":"Registry Loading &amp; Injection","text":"<p>The mod's behavior is entirely data-driven. Two JSON registries are loaded at startup (and on <code>/reload</code>) and injected into the runtime systems:</p> <pre><code>flowchart TD\n    subgraph Load [Datapack Loading]\n        BW[\"civil_blocks/*.json\"]\n        HT[\"civil_heads/*.json\"]\n        Merge[\"Merge &amp; resolve overrides&lt;br/&gt;(later-loaded datapacks override earlier ones)\"]\n\n        BW --&gt; Merge\n        HT --&gt; Merge\n    end\n\n    Merge --&gt;|block weights| ScoreEngine[\"Civilization Score Engine\"]\n    Merge --&gt;|head type definitions| HeadTracker[\"Head Tracker\"]\n\n    ScoreEngine --&gt;|\"O(1) score lookup\"| SpawnDecision[\"Spawn Decision\"]\n    HeadTracker --&gt;|\"proximity + conversion\"| SpawnDecision\n    SpawnDecision --&gt; Outcome[\"allow / block / convert\"]</code></pre> <ul> <li>Block weight registry determines which blocks are recognized and how much each contributes to civilization score</li> <li>Head type registry determines which skull types are active, their dimension restrictions, and whether they participate in conversion</li> <li>Both registries support full datapack override: modpacks can add, modify, or replace entries without touching mod code</li> </ul>"},{"location":"technical/performance/","title":"Performance","text":"<p>Civillis evaluates millions of blocks per spawn attempt while keeping each check at near-constant time. This page explains the optimization strategy and its real-world cost profile.</p>"},{"location":"technical/performance/#the-core-challenge","title":"The Core Challenge","text":"<p>Every time a hostile mob tries to spawn naturally, the engine must answer: \"How civilized is this location?\" This requires aggregating block data across a configurable detection area (default 240\u00d7240\u00d748 blocks = 675 voxel chunks). Doing this naively on every spawn attempt would be catastrophically expensive.</p> <p>The solution is a shard-based caching engine built on three pillars:</p> <ol> <li>Pre-aggregated results \u2014 The 675-chunk aggregation is computed once and cached. Subsequent spawn checks are a single map lookup: O(1), ~50 ns.</li> <li>Delta propagation \u2014 When blocks change, only the affected shard is recomputed and the difference is applied to cached results. No full re-aggregation ever runs after the initial computation.</li> <li>Palette pre-filtering \u2014 Before scanning 4,096 blocks in a chunk section, the engine checks Minecraft's internal block palette for recognized civilization blocks. Sections with no targets are skipped in ~1 \u03bcs instead of a ~100 \u03bcs full scan \u2014 in wilderness this eliminates virtually 100% of scanning work.</li> </ol>"},{"location":"technical/performance/#civilization-scoring-engine","title":"Civilization Scoring Engine","text":"<p>The following diagram shows the full data flow through the scoring engine \u2014 the component responsible for the O(1) spawn checks. All key paths (spawn checks, block changes, cold loading, prefetching, TTL eviction) are shown with their typical costs.</p> <pre><code>flowchart TD\n    SpawnCheck([\"Spawn Check\"])\n    BlockChange([\"Block Change\"])\n\n    SpawnCheck ~~~ BlockChange\n\n    Miss{{\"cache miss&lt;br/&gt;aggregate from L1&lt;br/&gt;~34 \u03bcs\"}}\n    Hit{{\"cache hit&lt;br/&gt;~50 ns\"}}\n    Delta{{\"recompute +&lt;br/&gt;propagate delta&lt;br/&gt;~13 \u03bcs\"}}\n\n    L1[(\"L1 Shards&lt;br/&gt;per-chunk scores\")]\n    Result[(\"Result Shards&lt;br/&gt;pre-aggregated\")]\n\n    SpawnCheck --&gt; Miss --&gt; L1\n    SpawnCheck --&gt; Hit --&gt; Result\n    BlockChange --&gt; Delta --&gt; Result\n\n    L1 --&gt;|\"distance-weighted aggregate\"| Result\n\n    Prefetch{{\"prefetch nearby&lt;br/&gt;~0.9 ms/s\"}}\n    Presence{{\"decay recovery&lt;br/&gt;~10 \u03bcs/s\"}}\n    ColdLoad{{\"cold read&lt;br/&gt;~0.1 ms\"}}\n    H2[(\"H2 Cold Store&lt;br/&gt;async I/O\")]\n    PlayerMove([\"Player Move (1/s)\"])\n\n    PlayerMove --&gt; Prefetch --&gt; L1\n    PlayerMove --&gt; Presence --&gt; Result\n    H2 --&gt; ColdLoad --&gt; L1\n    L1 --&gt;|\"TTL 5 min evict\"| H2\n    Result --&gt;|\"TTL 60 min evict\"| H2</code></pre>"},{"location":"technical/performance/#cost-summary","title":"Cost Summary","text":"Operation Typical cost Frequency Spawn check (warm) ~50 ns Every natural spawn attempt Spawn check (cold) ~34 \u03bcs First spawn in a new area L1 compute (palette skip) ~1 \u03bcs Most chunk sections L1 compute (full scan) ~100 \u03bcs Sections with civilization blocks Block change + delta ~13 \u03bcs Every block placement/removal Database cold read ~0.1 ms L1 evicted from memory Prefetch per player (moved) ~0.9 ms/s Once per second when player moves Prefetch per player (stationary) ~0.01 ms/s Once per second (presence only) <p>The scoring engine alone scales comfortably to hundreds of players. The real cost story, however, depends on what happens around it.</p>"},{"location":"technical/performance/#mob-flee-ai-performance-notes","title":"Mob Flee AI Performance Notes","text":"<p>Mob Flee AI is a behavior-layer system and is intentionally decoupled from the O(1) civilization score query path.</p> <ul> <li>It does not change the cache topology (L1/Result shards) or delta propagation math</li> <li>It runs on periodic evaluations per mob (interval + jitter), not every tick for every mob</li> <li>Its practical cost scales with active hostile mob count and configured flee cadence</li> </ul> <p>If a server needs stricter performance limits, <code>mobFlee.enabled=false</code> fully disables this behavior without affecting spawn suppression, decay, or head attraction.</p>"},{"location":"technical/performance/#runtime-cost-profile","title":"Runtime Cost Profile","text":"<p>At runtime, the core paths are all stable:</p> <ul> <li>Civilization score query is O(1) on warm cache (map lookup)</li> <li>Block change update stays constant-time at shard level (recompute + delta propagation)</li> <li>Monster head checks are handled by spatial indexing, so typical overhead remains low</li> </ul> <p>This means Civillis has no obvious performance hotspot in normal deployments. The dominant variable is still spawn-attempt volume (mob-cap churn), not one specific subsystem.</p>"},{"location":"technical/performance/#what-drives-cost-on-live-servers","title":"What Drives Cost on Live Servers","text":"<ul> <li>Spawn churn: dark civilized areas can increase retry volume when mob cap fills slowly</li> <li>Player movement: prefetch and cache maintenance scale with active movement</li> <li>Extreme local head density: only when many enabled heads are packed into one active area</li> </ul>"},{"location":"technical/performance/#multiplayer-server-budget","title":"Multiplayer Server Budget","text":"<p>The table below gives a compact planning view for common server sizes.</p> Server stage Typical active pattern Prefetch + presence Spawn pipeline Total Civillis cost Tick budget used Small (~10 players) 3 explorers + 7 builders in lit bases ~0.14 ms/tick ~0.12 ms/tick ~0.26 ms/tick ~0.5% Medium (~50 players) 10 explorers + 40 builders across multiple bases ~0.49 ms/tick ~0.75 ms/tick ~1.24 ms/tick ~2.5% Large (~100 players) 20 explorers + 80 builders, mixed lighting quality ~0.98 ms/tick ~2.60 ms/tick ~3.58 ms/tick ~7.2% <p>All values are rounded estimates under the stated assumptions; total cost is the sum of the two component columns in each row.</p> <p>Observed upside in very large modpacks</p> <p>In some heavy modpack environments, Civillis can improve overall server performance instead of only adding overhead. Real user feedback confirms this in Minecraft 1.20.1 Forge with 300+ mods: by reducing hostile mob pressure near established bases, total active-entity load and nearby AI churn can drop, which improves practical TPS stability. Treat this as an observed field result under specific pack conditions, not as a universal guarantee.</p> <p>Edge case: very dense head hotspots</p> <p>If many enabled heads are concentrated in one active attraction area, head-query overhead can become noticeable. Mitigation is straightforward: spread clusters, disable unused head types, or reduce attraction radius.</p>"}]}